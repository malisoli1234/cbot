<!-- Dashboard Page -->

<!-- Stats Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-number text-4xl font-bold" id="total-searches"><%= stats.totalSearches %></div>
        <div class="stat-label">کل جستجوها</div>
    </div>
    
    <div class="stat-card success">
        <div class="stat-number text-4xl font-bold" id="today-searches"><%= stats.todaySearches %></div>
        <div class="stat-label">جستجوهای امروز</div>
    </div>
    
    <div class="stat-card warning">
        <div class="stat-number text-4xl font-bold" id="processed-searches"><%= stats.processedSearches %></div>
        <div class="stat-label">پردازش شده</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number text-4xl font-bold" id="edited-messages"><%= stats.editedMessages %></div>
        <div class="stat-label">پیام‌های ویرایش شده</div>
    </div>
    
    <div class="stat-card danger">
        <div class="stat-number text-4xl font-bold" id="deleted-messages"><%= stats.deletedMessages %></div>
        <div class="stat-label">پیام‌های حذف شده</div>
    </div>
</div>

<!-- Site Stats -->
<div class="card">
    <div class="card-header">
        <h2 class="card-title">📈 آمار سایت‌ها</h2>
    </div>
    <div class="stats-grid" id="site-stats">
        <% siteStats.forEach(site => { %>
            <div class="stat-card">
                <div class="stat-number"><%= site.count %></div>
                <div class="stat-label"><%= site._id %></div>
                <div class="text-light">میانگین payout: <%= site.avgPayout ? site.avgPayout.toFixed(2) : 'N/A' %>%</div>
            </div>
        <% }); %>
    </div>
</div>

<!-- Recent Searches -->
<div class="card">
    <div class="card-header">
        <h2 class="card-title">🕒 آخرین جستجوها</h2>
        <a href="/admin/records" class="btn btn-primary">مشاهده همه</a>
    </div>
    
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>ارز</th>
                    <th>جستجو</th>
                    <th>وضعیت</th>
                    <th>سایت</th>
                    <th>تاریخ</th>
                </tr>
            </thead>
            <tbody>
                <% recentSearches.forEach(record => { %>
                    <tr>
                        <td><strong><%= record.currencyName %></strong></td>
                        <td><%= record.searchTerm %></td>
                        <td>
                            <span class="badge badge-<%= record.status === 'processed' ? 'success' : record.status === 'edited' ? 'info' : record.status === 'deleted' ? 'danger' : 'warning' %>">
                                <%= record.status %>
                            </span>
                        </td>
                        <td>
                            <% if (record.results && record.results.length > 0) { %>
                                <%= record.results[0].site %>
                            <% } else { %>
                                -
                            <% } %>
                        </td>
                        <td><%= new Date(record.createdAt).toLocaleString('fa-IR') %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    </div>
</div>

<!-- Quick Actions -->
<div class="card">
    <div class="card-header">
        <h2 class="card-title">⚡ عملیات سریع</h2>
    </div>
    
    <div class="d-flex justify-between">
        <a href="/admin/records" class="btn btn-primary">
            <i class="fas fa-database"></i>
            مدیریت رکوردها
        </a>
        
        <a href="/admin/sites" class="btn btn-success">
            <i class="fas fa-globe"></i>
            مدیریت سایت‌ها
        </a>
        
        <a href="/admin/settings" class="btn btn-warning">
            <i class="fas fa-cog"></i>
            تنظیمات
        </a>
        
        <button onclick="adminPanel.exportData()" class="btn btn-info">
            <i class="fas fa-download"></i>
            خروجی CSV
        </button>
    </div>
</div> 